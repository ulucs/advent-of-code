d:.+(`up`down`forward;(-1 0;1 0;0 1)); i:{d[x 0]*'0$x 1}+:(" "\)'r 2
*/ +/i
*/ +/'{(x*y;y)}/(+\;{x})@' +:i